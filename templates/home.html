{% extends "base.html" %}
{% block body %}
<h1 class="text-center my-5">ðŸš—VehiclesðŸš—</h1>
<div class="container d-flex justify-content-center align-items-center">
    <a class="btn btn-outline-info mb-3" href="{{ url_for('add_vehicle') }}">Add Vehicles</a>

</div>
{% with messages = get_flashed_messages()%}
{% if massages%}
    {% for massage in massages%}
    <p>{{massage}}</p>
    {%endfor%}
    {%endif%}
    {%endwith%}
<div class="container">
    <table class="table table-dark table-striped">
        <thead>
        <tr>
            <th scope="col">ID</th>
            <th scope="col">Vehicle</th>
            <th scope="col">Price(INR)</th>
            <th scope="col">Created on</th>
           <th> Actions </th>
        </tr>
        </thead>
        {% if not details%}
        <div class="text-center">
            <h3 class="my-5">No Records to Display!</h3>
        </div>
        {% else %}
        <tbody>
        {% for data in details %}
        <tr>
            <th scope="row">{{data.id}}</th>
            <td>{{data.name}}</td>
            <td>â‚¹{{data.price}}</td>
            <td>{{data.created_at}}</td>
            <td> <a class="btn btn-outline-info  mb-3" href="{{ url_for('update_vehicle_price', id=data.id) }}">Update Price</a> <a class="btn btn-outline-info mb-3" href="#" onclick="deleteVehicle({{ data.id }})">Delete</a> <a class="btn btn-outline-info mb-3" href="{{ url_for('delete_vehicle', id=data.id) }}">Delete</a></td>

        </tr>
        {% endfor %}
        </tbody>
        {% endif %}
    </table>


<script>
    function deleteVehicle(id) {
    fetch(`/delete-vehicle/${id}`, {
        method: 'DELETE',
        headers: {
            'Content-Type': 'application/json'
        },
    })
    .then(response => {
        if (response.ok) {
            console.log('Vehicle deleted successfully');
            // You can update the DOM here if you want to remove the deleted item from the list.
        } else {
            console.error('Failed to delete vehicle');
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}
</script>
</div>
{% endblock %}